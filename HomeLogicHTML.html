<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

    
    <HEAD>
        <style>
            BODY.popup {
                BACKGROUND-COLOR: #e1eaff
            }

            TD.menuselected {
                FONT-WEIGHT: normal;
                FONT-SIZE: 12px;
                COLOR: white;
                FONT-FAMILY: verdana, arial, helvetica, sans-serif;
                BACKGROUND-COLOR: #8da5eb;
                TEXT-DECORATION: none
            }

            TD.header {
                FONT-WEIGHT: normal;
                FONT-SIZE: 12px;
                COLOR: white;
                FONT-FAMILY: verdana, arial, helvetica, sans-serif;
                BACKGROUND-COLOR: #536a9c;
                TEXT-DECORATION: none
            }

            TD {
                FONT-WEIGHT: normal;
                FONT-SIZE: 10px;
                FONT-STYLE: normal;
                FONT-FAMILY: Verdana, arial, helvetica, sans-serif;
                TEXT-DECORATION: none
            }

                TD.plain {
                    FONT-WEIGHT: normal;
                    FONT-SIZE: 10px;
                    FONT-STYLE: normal;
                    FONT-FAMILY: Verdana, arial, helvetica, sans-serif;
                    TEXT-DECORATION: none
                }

            TR.header {
                BACKGROUND-COLOR: #536a9c
            }

            TR.caption {
                BACKGROUND-COLOR: #8da5eb
            }

            TR.caption2 {
                BACKGROUND-COLOR: #b4c4f1
            }

            TR.odd {
                BACKGROUND-COLOR: #e1eaff
            }

            TR.even {
                BACKGROUND-COLOR: #c3d6ff
            }

            TR.plain {
                BACKGROUND-COLOR: #ffffff
            }

            A:link {
                COLOR: #0000ff;
                TEXT-DECORATION: none
            }

            A:visited {
                COLOR: #0000ff;
                TEXT-DECORATION: none
            }

            A:hover {
                COLOR: #0000ff;
                TEXT-DECORATION: underline
            }

            A.plain:link {
                COLOR: black;
                TEXT-DECORATION: none
            }

            A.plain:visited {
                COLOR: black;
                TEXT-DECORATION: none
            }

            A.plain:hover {
                COLOR: black;
                TEXT-DECORATION: none
            }

            A.menu:link {
                COLOR: white;
                TEXT-DECORATION: none
            }

            A.menu:visited {
                COLOR: white;
                TEXT-DECORATION: none
            }

            A.menu:hover {
                COLOR: white;
                TEXT-DECORATION: underline
            }

            A.hover:link {
                COLOR: black;
                TEXT-DECORATION: none
            }

            A.hover:visited {
                COLOR: black;
                TEXT-DECORATION: none
            }

            A.hover:hover {
                COLOR: black;
                TEXT-DECORATION: underline
            }

            SELECT {
                FONT-WEIGHT: normal;
                FONT-SIZE: 10px;
                FONT-FAMILY: Verdana, Arial, helvetica, sans-serif;
                TEXT-DECORATION: none
            }

            TEXTAREA {
                FONT-WEIGHT: normal;
                FONT-SIZE: 10px;
                FONT-FAMILY: Verdana, Arial, helvetica, sans-serif;
                TEXT-DECORATION: none
            }

            INPUT {
                FONT-WEIGHT: normal;
                FONT-SIZE: 10px;
                FONT-FAMILY: Verdana, Arial, helvetica, sans-serif;
                TEXT-DECORATION: none
            }

            @media print {
                .printbutton {
                    display: none;
                }
            }
        </style>
    </HEAD>
    <BODY>
        <form name="gbGradesEntryBody" id="gbGradesEntryBody" method="post">
            <input type=hidden name=submitted id=submitted value="no">
            <input type=hidden name=changedField id=changedField value="no">
            <input type=hidden name=studentCount id=studentCount value="4">
            <input type=hidden name=submitComplete id=submitComplete value="">

            <Table Width=97% Border="0" vAlign=Top cellSpacing=0 cellPadding=0>
                <input type=hidden name=CategoryID id=CategoryID value=143468>
                <INPUT TYPE="hidden" NAME="AlphaCount" ID="AlphaCount" VALUE=0>
                <Input Type="hidden" Name="StudentCount" Id="StudentCount" Value=4>
                <INPUT TYPE="hidden" NAME="DefnAffect136" ID="DefnAffect136" VALUE="FALSE">
                <INPUT TYPE="hidden" NAME="DefnAffect236" ID="DefnAffect236" VALUE="FALSE">
                <INPUT TYPE="hidden" NAME="DefnAffect246" ID="DefnAffect246" VALUE="FALSE">
                <INPUT TYPE="hidden" NAME="DefnAffect247" ID="DefnAffect247" VALUE="TRUE">
                <INPUT TYPE="hidden" NAME="DefnAffect235" ID="DefnAffect235" VALUE="FALSE">
                <INPUT TYPE="hidden" NAME="DefnAffect245" ID="DefnAffect245" VALUE="TRUE">
                <INPUT TYPE="hidden" NAME="DefnAffect137" ID="DefnAffect137" VALUE="TRUE">
                <input type=hidden name="OutOf" id="OutOf" value="26">
                <input type=hidden name="AllowExtra" id="AllowExtra" value="FALSE">
                <tr class="even">
                    <td vAlign=CENTER WIDTH="*" Height=5>
                        Chen, Eric    Junyan (303397)<font color='darkred'>M</font><a title='Student Email Current:Yes'><font color='darkred'>E</font></a>
                    </td>
                    <td valign=center width="8%"><a href="javascript:TaskNote('229168','15846','3229177');">[Note]</a></td>

                    <td Align=center Width="8%" NoWrap>
                        <Input Type=Checkbox onclick=javascript:Changed('15846'); Name="chk15846" Id="chk15846">
                    </td>
                    <td ALIGN=RIGHT WIDTH="15%" NOWRAP>
                        <Select Name="cboDefn15846" Id="cboDefn15846" Language=javascript onchange="cboDefn_onchange('15846');">
                            <Option Value="NULL"></Option>
                            <OPTION VALUE="136">E</OPTION>
                            <OPTION VALUE="236">Ex</OPTION>
                            <OPTION VALUE="246">INC</OPTION>
                            <OPTION VALUE="247">INC0</OPTION>
                            <OPTION VALUE="235">NHI</OPTION>
                            <OPTION VALUE="245">NHI0</OPTION>
                            <OPTION VALUE="137" SELECTED>NR</OPTION>
                        </Select>
                    </td>
                    <td vAlign=Center Width="15%"><INPUT TYPE="text" SIZE=6 MAXLENGTH=6 NAME="grade15846" ID="grade15846" VALUE="" Language="javascript" onkeyup="CheckChange(grade15846,'15846');" onFocus="ChangeStudent(15846);" onblur="CheckBlank(grade15846,'15846');" TabIndex=1></td>
                </tr>
                <Input Type="hidden" Name="id15846" Id="id15846" Value="15846">
                <Input Type="hidden" Name="task15846" Id="task15846" Value="229168">
                <Input Type="hidden" Name="sgID15846" Id="sgID15846" Value="3229177">
                <Input Type="hidden" Name="GradeChanged15846" Id="GradeChanged15846" Value=no>
                <Input Type="hidden" Name="countid1" Id="countid1" Value="15846">
                <Input Type="hidden" Name="studentcount15846" Id="studentcount15846" Value="1">
                <Input Type="hidden" Name="prevStud15846" Id="prevStud15846" Value=0>
                <Input Type="hidden" Name="nextStud15846" Id="nextStud15846" Value=0>
                <Input Type="hidden" Name="points1" Id="points1" Value="26">
                <tr class="odd">
                    <td vAlign=CENTER WIDTH="*" Height=5>
                        Levin, Iwan (308734)<font color='darkred'>M</font><a title='Student Email Current:Yes'><font color='darkred'>E</font></a>
                    </td>
                    <td valign=center width="8%"><a href="javascript:TaskNote('229168','21558','3229137');">[Note]</a></td>

                    <td Align=center Width="8%" NoWrap>
                        <Input Type=Checkbox onclick=javascript:Changed('21558'); Name="chk21558" Id="chk21558">
                    </td>
                    <td ALIGN=RIGHT WIDTH="15%" NOWRAP>
                        <Select Name="cboDefn21558" Id="cboDefn21558" Language=javascript onchange="cboDefn_onchange('21558');">
                            <Option Value="NULL"></Option>
                            <OPTION VALUE="136">E</OPTION>
                            <OPTION VALUE="236">Ex</OPTION>
                            <OPTION VALUE="246">INC</OPTION>
                            <OPTION VALUE="247">INC0</OPTION>
                            <OPTION VALUE="235">NHI</OPTION>
                            <OPTION VALUE="245">NHI0</OPTION>
                            <OPTION VALUE="137">NR</OPTION>
                        </Select>
                    </td>
                    <td vAlign=Center Width="15%"><INPUT TYPE="text" SIZE=6 MAXLENGTH=6 NAME="grade21558" ID="grade21558" VALUE="12.75" Language="javascript" onkeyup="CheckChange(grade21558,'21558');" onFocus="ChangeStudent(21558);" onblur="CheckBlank(grade21558,'21558');" TabIndex=1></td>
                </tr>
                <Input Type="hidden" Name="id21558" Id="id21558" Value="21558">
                <Input Type="hidden" Name="task21558" Id="task21558" Value="229168">
                <Input Type="hidden" Name="sgID21558" Id="sgID21558" Value="3229137">
                <Input Type="hidden" Name="GradeChanged21558" Id="GradeChanged21558" Value=no>
                <Input Type="hidden" Name="countid2" Id="countid2" Value="21558">
                <Input Type="hidden" Name="studentcount21558" Id="studentcount21558" Value="2">
                <Input Type="hidden" Name="prevStud21558" Id="prevStud21558" Value=-99>
                <Input Type="hidden" Name="nextStud21558" Id="nextStud21558" Value=6933>
                <Input Type="hidden" Name="points2" Id="points2" Value="26">
                <tr class="even">
                    <td vAlign=CENTER WIDTH="*" Height=5>
                        Lysack, Daniel (27335)<a title='Student Email Current:Yes'><font color='darkred'>E</font></a>
                    </td>
                    <td valign=center width="8%"><a href="javascript:TaskNote('229168','6933','3229178');">[Note]</a></td>

                    <td Align=center Width="8%" NoWrap>
                        <Input Type=Checkbox onclick=javascript:Changed('6933'); Name="chk6933" Id="chk6933">
                    </td>
                    <td ALIGN=RIGHT WIDTH="15%" NOWRAP>
                        <Select Name="cboDefn6933" Id="cboDefn6933" Language=javascript onchange="cboDefn_onchange('6933');">
                            <Option Value="NULL"></Option>
                            <OPTION VALUE="136">E</OPTION>
                            <OPTION VALUE="236">Ex</OPTION>
                            <OPTION VALUE="246">INC</OPTION>
                            <OPTION VALUE="247">INC0</OPTION>
                            <OPTION VALUE="235">NHI</OPTION>
                            <OPTION VALUE="245">NHI0</OPTION>
                            <OPTION VALUE="137">NR</OPTION>
                        </Select>
                    </td>
                    <td vAlign=Center Width="15%"><INPUT TYPE="text" SIZE=6 MAXLENGTH=6 NAME="grade6933" ID="grade6933" VALUE="19" Language="javascript" onkeyup="CheckChange(grade6933,'6933');" onFocus="ChangeStudent(6933);" onblur="CheckBlank(grade6933,'6933');" TabIndex=1></td>
                </tr>
                <Input Type="hidden" Name="id6933" Id="id6933" Value="6933">
                <Input Type="hidden" Name="task6933" Id="task6933" Value="229168">
                <Input Type="hidden" Name="sgID6933" Id="sgID6933" Value="3229178">
                <Input Type="hidden" Name="GradeChanged6933" Id="GradeChanged6933" Value=no>
                <Input Type="hidden" Name="countid3" Id="countid3" Value="6933">
                <Input Type="hidden" Name="studentcount6933" Id="studentcount6933" Value="3">
                <Input Type="hidden" Name="prevStud6933" Id="prevStud6933" Value=21558>
                <Input Type="hidden" Name="nextStud6933" Id="nextStud6933" Value=21559>
                <Input Type="hidden" Name="points3" Id="points3" Value="26">
                <tr class="odd">
                    <td vAlign=CENTER WIDTH="*" Height=5>
                        Moravek, Paris-Brittney (30...
                    </td>
                    <td valign=center width="8%"><a href="javascript:TaskNote('229168','21559','3229179');">[Note]</a></td>

                    <td Align=center Width="8%" NoWrap>
                        <Input Type=Checkbox onclick=javascript:Changed('21559'); Name="chk21559" Id="chk21559">
                    </td>
                    <td ALIGN=RIGHT WIDTH="15%" NOWRAP>
                        <Select Name="cboDefn21559" Id="cboDefn21559" Language=javascript onchange="cboDefn_onchange('21559');">
                            <Option Value="NULL"></Option>
                            <OPTION VALUE="136">E</OPTION>
                            <OPTION VALUE="236">Ex</OPTION>
                            <OPTION VALUE="246">INC</OPTION>
                            <OPTION VALUE="247">INC0</OPTION>
                            <OPTION VALUE="235">NHI</OPTION>
                            <OPTION VALUE="245">NHI0</OPTION>
                            <OPTION VALUE="137">NR</OPTION>
                        </Select>
                    </td>
                    <td vAlign=Center Width="15%"><INPUT TYPE="text" SIZE=6 MAXLENGTH=6 NAME="grade21559" ID="grade21559" VALUE="25" Language="javascript" onkeyup="CheckChange(grade21559,'21559');" onFocus="ChangeStudent(21559);" onblur="CheckBlank(grade21559,'21559');" TabIndex=1></td>
                </tr>
                <Input Type="hidden" Name="id21559" Id="id21559" Value="21559">
                <Input Type="hidden" Name="task21559" Id="task21559" Value="229168">
                <Input Type="hidden" Name="sgID21559" Id="sgID21559" Value="3229179">
                <Input Type="hidden" Name="GradeChanged21559" Id="GradeChanged21559" Value=no>
                <Input Type="hidden" Name="countid4" Id="countid4" Value="21559">
                <Input Type="hidden" Name="studentcount21559" Id="studentcount21559" Value="4">
                <Input Type="hidden" Name="prevStud21559" Id="prevStud21559" Value=6933>
                <Input Type="hidden" Name="nextStud21559" Id="nextStud21559" Value=-99>
                <Input Type="hidden" Name="points4" Id="points4" Value="26">
            </Table>
        </form>
    </BODY>
    </TABLE>
    </form>
</body>
</html>
<script language="javascript">

    function getGrades(list, tRows) {
        var grades = [];
        var studentIds = [];
        var out_of;

        for (i = 0; i < list.length; i++) {
            if (list[i].getAttribute("NAME").includes("grade")) {
                grades.push(list[i].getAttribute("VALUE"));
                console.log((list[i].getAttribute("VALUE")));
            }
            else if (list[i].getAttribute("NAME").includes("points")) {
                out_of = list[i].getAttribute("Value");
            }
        }

        for (i = 0; i < tRows.length; i++) {
            if (tRows[i].getAttribute("class") === "even" || tRows[i].getAttribute("class") === "odd") {
                var td = document.getElementsByTagName("td");
                studentIds.push(td[0].innerHTML);
                console.log(td[0].innerHTML);
            }

        }
    }


    function Test() {
        // array of all table data elements
        var list = document.getElementsByTagName("INPUT");
        var rows = document.getElementsByTagName("tr");
        //print value of each element
        for (i = 0; i < list.length; i++) {
            // console.log(list[i].getAttribute("VALUE"));
        //alert(list[i].VALUE);
        };
        getGrades(list, rows);
    }

    
    Test();

var myvariable;
	myvariable = false;

function CheckBlank(name,drop){
	var temp;
	if (name.value == "") {
		temp = "window.document.gbGradesEntryBody.chk" + drop + ".checked = false";
		eval(temp);
	}
}

function CheckChange(name, id){
	Changed(id);
	var contents   = name.value;
	var alphacount = window.document.gbGradesEntryBody.AlphaCount.value;
	var iAlpha     = 1;
	var AlphaEquiv;
	var AlphaMin;
	var AlphaCode;
	var AlphaFinal;
	var obj;
	var result;
	var bDone = false;
	var tempS, tempO, index = 0;
	var points = window.document.gbGradesEntryBody.OutOf.value;
	var credit = window.document.gbGradesEntryBody.AllowExtra.value;

    if ((((contents+1) / (contents+1)) != 1) && (contents != 0)){
		alert('Please enter only a number into the Grade field.\nThe Grade will be set to 0.');
		name.value = 0;
		contents = 0;
		if (alphacount > 0){
			tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.Alpha' + id +'[' + alphacount + ']';
			obj = eval(tempS);
			obj.selected = true;
		}
	}
	else if ((credit == "FALSE") && (Number(contents) > Number(points))){
		alert('Please enter a Grade equal to or less than ' + points + '.\nThe Grade will be set to 0.');
		name.value = 0;
		contents = 0;
		if (alphacount > 0){
			tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.Alpha' + id +'[' + alphacount + ']';
			obj = eval(tempS);
			obj.selected = true;
		}
	}
	else if ((credit == "TRUE") && (Number(contents) > Number(points))){
		//alert('The Grade you entered exceeds ' + points + '.');
		if (alphacount > 0){
			tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.Alpha' + id +'[' + alphacount + ']';
			obj = eval(tempS);
			obj.selected = true;
		}
	}
	if (Number(contents) < 0){
		alert('Please enter only a positive Grade.\n The Grade will be set to ' + (name.value * -1) + '.');
		name.value = (name.value * -1);
		contents = name.value;
		if (alphacount > 0){
			tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.Alpha' + id +'[' + alphacount + ']';
			obj = eval(tempS);
			obj.selected = true;
		}
	}

	if (alphacount > 0){
		tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaMin1';
		tempO = eval(tempS);
		AlphaMin = tempO.value;
		tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaCode1';
		tempO = eval(tempS);
		AlphaCode = tempO.value
		AlphaFinal = AlphaCode;
		index = 0;
		for (iAlpha = 1; iAlpha <= alphacount; iAlpha++){
			tempS      = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaMin' + iAlpha;
			tempO      = eval(tempS);
			AlphaMin   = tempO.value;
			tempS      = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaEquiv' + iAlpha;
			tempO      = eval(tempS);
			AlphaEquiv = tempO.value;
			tempS      = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaCode' + iAlpha;
			tempO      = eval(tempS);
			AlphaCode  = tempO.value;
			result     = (AlphaMin / 100 * points);
			if (!bDone){
				index++;
			}
			if ((contents >= result) && (!bDone)){
				AlphaFinal = AlphaCode;
				bDone = true;
			}
		}
		if (contents == ''){
			index = 0;
			AlphaFinal = '';
		}
		else{
			for (iAlpha = 1; iAlpha <= alphacount; iAlpha++){
				tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.Alpha' + id + '['+ iAlpha +']';
				obj = eval(tempS);
				obj.selected = false;
			}
			if (contents == 0) {
				index = alphacount;
			}
			tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.Alpha' + id +'['+ index +']';
			obj = eval(tempS);
			obj.selected = true;
		}
	}
}

function round(number,X) {
    return Math.round(number*Math.pow(10,X))/Math.pow(10,X);
}

function CheckAlpha(name,id,outof){
	Changed(id);
	var alphacount = top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaCount.value;
	var iAlpha = 1;
	var AlphaEquiv;
	var result = 0;
	var obj;
	var tempS;
	for (iAlpha = 1; iAlpha <= alphacount; iAlpha++){
		tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaCode' + iAlpha + '.value';
		if (eval(tempS) == (name.value)){
			tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaEquiv' + iAlpha + '.value';
			AlphaEquiv = eval(tempS);
			result = round(AlphaEquiv / 100 * outof, 2);
			tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.grade' + id;
			obj = eval(tempS);
			obj.value = result;
		}
	}
	if (name.value == 'NULL'){
		tempS     = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.grade' + id;
		obj       = eval(tempS);
		obj.value = '';
	}
}

function cboDefn_onchange(iStudentID){
	Changed(iStudentID);
	var ocboDefn     = eval('window.document.gbGradesEntryBody.cboDefn' + iStudentID);
	var oAlphaSelect = eval('window.document.gbGradesEntryBody.Alpha' + iStudentID);
	var oGrade       = eval('window.document.gbGradesEntryBody.grade' + iStudentID);


	var count = eval('top.window.frames.GradeTaskBody.document.gbGradesEntryBody.studentcount' + iStudentID + ".value")*1;
	var prevStudent =  eval('window.document.gbGradesEntryBody.prevStud' + iStudentID + ".value");
	var nextStudent =  eval('window.document.gbGradesEntryBody.nextStud' + iStudentID + ".value");

	if (ocboDefn.value=='NULL'){
		if (oAlphaSelect)
			oAlphaSelect.disabled = false;

		oGrade.disabled = false;

		var pCount = count;

		//loop backwards until we find a student
		while (pCount >1 && prevStudent==0){
			pCount = pCount - 1;
			var sid = eval('window.document.gbGradesEntryBody.countid' + pCount + ".value");


			if (sid == "undefined")
				prevStudent = -99;
			else
				prevStudent =  eval('window.document.gbGradesEntryBody.prevStud' + sid + ".value")*1;

			if (prevStudent != 0)
				break;
		}
		if (pCount == 1 && prevStudent == 0){
			eval('window.document.gbGradesEntryBody.prevStud' + iStudentID + ".value=-99;");
		}
		else{
			eval('window.document.gbGradesEntryBody.prevStud' + iStudentID + ".value=" + sid);
				eval('window.document.gbGradesEntryBody.nextStud' + sid + ".value=" + iStudentID);
		}

		//loop forwards until we find a student
		var nCount = count;
		var studentCount = window.document.gbGradesEntryBody.studentCount.value*1;
		while (nCount < studentCount && nextStudent==0){
			nCount = nCount + 1;
			var sid = eval('window.document.gbGradesEntryBody.countid' + nCount + ".value");
			if (sid =="undefined")
				nextStudent = -99;
			else
				nextStudent =  eval('window.document.gbGradesEntryBody.prevStud' + sid + ".value")*1;

			//alert(nCount +"\n" + sid + "\n" + nextStudent);
			if (nextStudent != 0)
				break;
		}


		//alert("Next: " + nCount +"\n" + sid + "\n" + nextStudent);
		if (nCount == studentCount && nextStudent == 0){
		eval('window.document.gbGradesEntryBody.nextStud' + iStudentID + ".value=-99;");

		}
		else{
			eval('window.document.gbGradesEntryBody.nextStud' + iStudentID + ".value=" + sid);
				eval('window.document.gbGradesEntryBody.prevStud' + sid + ".value=" + iStudentID);
		}


	}
	else{
		if (oAlphaSelect){
			oAlphaSelect.selectedIndex = 0;
			oAlphaSelect.disabled = true;
		}

		oGrade.value='';
		oGrade.disabled = true;



		if (nextStudent > 0)
			eval('window.document.gbGradesEntryBody.prevStud' + nextStudent + ".value=" +eval('window.document.gbGradesEntryBody.prevStud' + iStudentID + ".value") );

		if (prevStudent > 0)
			eval('window.document.gbGradesEntryBody.nextStud' + prevStudent + ".value=" +eval('window.document.gbGradesEntryBody.nextStud' + iStudentID + ".value") );


		//clear the non-used value
		eval('window.document.gbGradesEntryBody.prevStud' + iStudentID + ".value=0");
		eval('window.document.gbGradesEntryBody.nextStud' + iStudentID + ".value=0");


	}

}
function ChangeStudent(sid){
	var count = eval('top.window.frames.GradeTaskBody.document.gbGradesEntryBody.studentcount' + sid + ".value")*1;
	var prevStudent = "grade" + eval('window.document.gbGradesEntryBody.prevStud' + sid + ".value");
	var nextStudent = "grade" +eval('window.document.gbGradesEntryBody.nextStud' + sid + ".value");

	lastGrade = prevStudent;
	nextGrade = nextStudent;
}

	//make enter work like tab
	var nextGrade, netscape, ver, len, iln,lastGrade;
	nextGrade = "grade-99";
	lastGrade = "grade-99";
	netscape = "";
	ver = navigator.appVersion;
	len = ver.length;
	for(iln=0; iln < len; iln++){
		if (ver.charAt(iln) == "(")
			break;
	}
	netscape = (ver.charAt(iln+1).toUpperCase() != "C");

	function keyDown (DnEvents){
		var key;
		key = (netscape) ? DnEvents.which : window.event.keyCode;

		if (key == 13 || key ==40 ){ //the enter key or down arrow
			if (nextGrade == 'grade-99'){
				return true;
			}
			else{
				try{
					var oField = eval('window.document.gbGradesEntryBody.' + nextGrade);
					oField.select();
				}
				catch(er){
					alert("The following Student has a Grade Status entered.\nA Numeric Grade cannot be entered.");
				}
				return false;
			}
		}
		if (key == 38){ //the up arrow
			if (lastGrade == 'grade-99'){
				return true;
			}
			else{
				try{
					eval('document.gbGradesEntryBody.' + lastGrade + '.select();');
				}
				catch(er){
					alert("The previous Student has a Grade Status entered.\nA Numeric Grade cannot be entered.");
				}
				return false;
			}
		}
	}

	document.onkeydown = keyDown;

function getHighestGrade(){
	var i;
	var count = document.gbGradesEntryBody.StudentCount.value*1;
	var high = 0;
	var student;
	var grade;
	for (i=1;i <= count;i++){
		student = eval("window.document.gbGradesEntryBody.countid"+i+".value");
		grade = eval("window.document.gbGradesEntryBody.grade"+student+".value")*1;
		if (grade > high){
			high= grade;
		}
	}
	return high
}

function setAlphas(){
	var alphacount   = window.document.gbGradesEntryBody.AlphaCount.value;
	var StudentCount = window.document.gbGradesEntryBody.StudentCount.value;
	var iAlpha;
	var iStudent;
	var iPoints;
	var StudentID;
	var StudentGrade;
	var AlphaEquiv;
	var AlphaMin;
	var AlphaCode;
	var AlphaFinal;
	var obj;
	var result;
	var bDone = false;
	var tempS, index = 0;
	var bSetFocus = false;
	var oSetFocus ;

	if ((alphacount > 0) && (StudentCount > 0)){
		for (iStudent = 1; iStudent <= StudentCount; iStudent++){
			tempS        = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaMin1.value';
			AlphaMin     = eval(tempS);
			tempS        = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaCode1.value';
			AlphaCode    = eval(tempS);
			AlphaFinal   = AlphaCode;
			tempS        = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.countid' + iStudent + '.value';
			StudentID    = eval(tempS);
			tempS        = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.grade' + StudentID + '.value';
			StudentGrade = eval(tempS);
			bDone        = false;
			index        = 0;


			if (bSetFocus == false){
				oSetFocus = eval('top.window.frames.GradeTaskBody.document.gbGradesEntryBody.grade'  + StudentID);
				if ((oSetFocus) && (!oSetFocus.disabled)){
					if ((oSetFocus.type)== "text"){
						if (window.document.gbGradesEntryBody.submitComplete.value != "yes"){
							oSetFocus.focus();
							bSetFocus = true ;
						}
					}
				}
			}

			for (iAlpha = 1; iAlpha <= alphacount; iAlpha++){
				tempS      = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaMin' + iAlpha + '.value';
				AlphaMin   = eval(tempS);

				tempS      = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.points' + iStudent + '.value';
				iPoints    = eval(tempS);


				result     = (AlphaMin / 100 * iPoints);
				if (!bDone){
					index++;
				}
				if ((StudentGrade >= result) && (!bDone)){
					//AlphaFinal = eval('top.window.frames.GradeTaskBody.document.gbGradesEntryBody.AlphaCode' + iAlpha + '.value');//AlphaCode
					bDone = true;
					iAlpha = alphacount + 1;
				}
			}
			if (StudentGrade == ''){
				index = 0;
				//AlphaFinal = '';
			}
			tempS        = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.Alpha' + StudentID + '['+ index +']';
			obj          = eval(tempS);
			obj.selected = true;
		}
	}
	else if (StudentCount > 0){
		for (iStudent = 1; iStudent <= StudentCount; iStudent++){
			if (bSetFocus == false){
				tempS = 'top.window.frames.GradeTaskBody.document.gbGradesEntryBody.countid' + iStudent + '.value';
				StudentID = eval(tempS);
				oSetFocus = eval('top.window.frames.GradeTaskBody.document.gbGradesEntryBody.grade'  + StudentID);

				if ((oSetFocus) && (!oSetFocus.disabled)){
					if (oSetFocus.type== "text" && window.document.gbGradesEntryBody.submitComplete.value !="yes"){
						oSetFocus.focus();
						oSetFocus.select();
						bSetFocus = true ;
					}
				}
			}
		}
	}
}

function Demographics(QS){
	top.window.open('../Demographics/gbStudentDemographics.asp?' + QS,'PopUp','height=385,width=415,fullscreen=no,resizable=yes,titlebar=Student Demographics');
}

function setDefns(){
	var StudentCount = window.document.gbGradesEntryBody.StudentCount.value;
	var oDefn;
	var iStudent = 1;
	var StudentID = eval('window.document.gbGradesEntryBody.countid'+ iStudent +'.value');
	var oAlphaSelect = eval('window.document.gbGradesEntryBody.Alpha'+ StudentID);
	var oGrade = eval('window.document.gbGradesEntryBody.grade'+ StudentID);

	if (StudentCount > 0){
		oDefn = eval('window.document.gbGradesEntryBody.cboDefn'+ StudentID);

		if (oDefn)
			{
			if (oDefn.selectedIndex > 0)
				{
				if (oDefn.value=='NULL')
					{
					if (oAlphaSelect){
						oAlphaSelect.disabled = false;
					}
					oGrade.disabled = false;
					}
				else
					{
					if (oAlphaSelect)
						{
						oAlphaSelect.selectedIndex = 0;
						oAlphaSelect.disabled = true;
						}
					oGrade.value = '';
					oGrade.disabled = true;
					}
				}
			for (iStudent=2; iStudent<=StudentCount; iStudent++)
				{
				StudentID = eval('window.document.gbGradesEntryBody.countid'+ iStudent +'.value');
				oDefn = eval('window.document.gbGradesEntryBody.cboDefn'+ StudentID);
				oAlphaSelect = eval('window.document.gbGradesEntryBody.Alpha'+ StudentID);
				oGrade = eval('window.document.gbGradesEntryBody.grade'+ StudentID);

				if (oDefn.value=='NULL')
					{
					if (oAlphaSelect)
						{
						oAlphaSelect.disabled = false;
						}
					oGrade.disabled = false;
					}
				else
					{
					if (oAlphaSelect)
						{
						oAlphaSelect.selectedIndex = 0;
						oAlphaSelect.disabled = true;
						}
					oGrade.value = '';
					oGrade.disabled = true;
					}
				}
			}
		}
	}

setDefns();
setAlphas();
/**/
function Changed(iStudentID){
	window.document.gbGradesEntryBody.changedField.value="yes";
	eval('window.document.gbGradesEntryBody.GradeChanged'+iStudentID+'.value="yes"');
}

function TaskNote(iTaskID,iStudentID,iGradeID){
	window.open("../Tasks/TaskComment.asp?from=GradeEntryTask&TaskID="+iTaskID + "&StudentID="+iStudentID + "&GradeID="+iGradeID,"StudentCommentPopUp","top=15,left=15,width=375,height=290,status=no,resizable=no,scrollbars=no,location=no,toolbar=no,directories=no");
}

function AdministrativeDisable()
	{
		for(i = 0; i < document.forms[0].elements.length; i++) {
			var elm = document.forms[0].elements[i];
			elm.disabled=true;
		}
	}

  
</script>
